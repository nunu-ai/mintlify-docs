---
title: 'Initiate Upload'
openapi: 'POST /builds/upload'
noindex: true
---

<Info>
  **Permission Required**: `project:manage-build-storage`
</Info>

Initiate a build upload. The API automatically selects single-part or multipart upload based on file size.

<Tip>
  **For most users**, we recommend using the [CLI](/ci-cd-integration/build-storage/quick-start) or [GitHub Action](/ci-cd-integration/build-storage/integrations/github-action) instead of the API directly.
</Tip>

## Upload Methods

| Method | File Size | Use Case |
| --- | --- | --- |
| **Single-part** | < 3GB | Simple uploads |
| **Multipart** | ≥ 3GB (up to 5TB) | Large files, parallel uploads |

The API automatically uses multipart for files ≥3GB unless you explicitly set `multipart: false`.

## Request Body

<ParamField body="project_id" type="string" required>
  Project ID for the build
</ParamField>

<ParamField body="name" type="string" required>
  Build name (1-255 characters)
</ParamField>

<ParamField body="file_name" type="string" required>
  File name (1-255 characters)
</ParamField>

<ParamField body="file_size" type="integer" required>
  Size in bytes (positive integer)
</ParamField>

<ParamField body="platform" type="string" required>
  Target platform: `windows`, `macos`, `linux`, `android`, `ios-native`, `ios-simulator`, `xbox`, `playstation`
</ParamField>

<ParamField body="description" type="string">
  Description (max 1000 characters)
</ParamField>

<ParamField body="multipart" type="boolean">
  Force multipart upload. Auto-enabled for files ≥3GB.
</ParamField>

<ParamField body="auto_delete" type="boolean" default="false">
  Auto-delete old builds when storage capacity is reached
</ParamField>

<ParamField body="deletion_policy" type="string" default="least_recent">
  Deletion policy: `least_recent` (LRU) or `oldest` (FIFO)
</ParamField>

<ParamField body="upload_timeout" type="integer">
  Timeout in minutes (1-1440). Default: 10 for single-part, 60 for multipart.
</ParamField>

<ParamField body="tags" type="string[]">
  Array of tags (1-50 characters each)
</ParamField>

<ParamField body="details" type="object">
  Build metadata (VCS, CI, app info)

  <Expandable title="details properties">
    <ParamField body="details.vcs" type="object">
      Version control metadata

      <Expandable title="vcs properties">
        <ParamField body="details.vcs.type" type="string">
          VCS type: `git`, `mercurial`, `svn`
        </ParamField>
        <ParamField body="details.vcs.provider" type="string">
          Provider: `github`, `gitlab`, `bitbucket`, `azure-devops`
        </ParamField>
        <ParamField body="details.vcs.branch" type="string">
          Branch name
        </ParamField>
        <ParamField body="details.vcs.commit" type="object">
          Commit info (hash, short_hash, message, author, timestamp)
        </ParamField>
      </Expandable>
    </ParamField>

    <ParamField body="details.ci" type="object">
      CI/CD metadata (system, build_number, job_name, run_url)
    </ParamField>

    <ParamField body="details.app" type="object">
      App metadata (version, version_code, build_number, bundle_id)
    </ParamField>
  </Expandable>
</ParamField>

## Response (Single-Part)

<ResponseField name="upload_type" type="string" required>
  Always `single-part`
</ResponseField>

<ResponseField name="build_id" type="string" required>
  Build ID for completing the upload
</ResponseField>

<ResponseField name="upload_url" type="string" required>
  Presigned URL to PUT the file
</ResponseField>

<ResponseField name="object_key" type="string" required>
  Object key for the upload
</ResponseField>

## Response (Multipart)

<ResponseField name="upload_type" type="string" required>
  Always `multipart`
</ResponseField>

<ResponseField name="build_id" type="string" required>
  Build ID for completing the upload
</ResponseField>

<ResponseField name="upload_id" type="string" required>
  Upload ID for getting part URLs
</ResponseField>

<ResponseField name="object_key" type="string" required>
  Object key for the upload
</ResponseField>

<ResponseField name="total_parts" type="integer" required>
  Total number of parts to upload
</ResponseField>

<ResponseField name="part_size" type="integer" required>
  Size of each part in bytes (typically 100MB)
</ResponseField>

<RequestExample>
```bash cURL
curl -X POST "https://nunu.ai/api/v1/builds/upload" \
  -H "X-Api-Key: YOUR_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "project_id": "your-project-id",
    "name": "Production Build v1.2.3",
    "file_name": "app-release.apk",
    "file_size": 52428800,
    "platform": "android",
    "multipart": false,
    "auto_delete": true,
    "tags": ["version:1.2.3", "env:production"],
    "details": {
      "vcs": {
        "commit": { "short_hash": "a1b2c3d" },
        "branch": "main"
      }
    }
  }'
```

```typescript JavaScript
const response = await fetch("https://nunu.ai/api/v1/builds/upload", {
  method: "POST",
  headers: {
    "X-Api-Key": process.env.NUNU_API_TOKEN,
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    project_id: "your-project-id",
    name: "Production Build v1.2.3",
    file_name: "app-release.apk",
    file_size: 52428800,
    platform: "android",
    multipart: false,
  }),
});
const data = await response.json();
```

```python Python
import requests
import os

response = requests.post(
    "https://nunu.ai/api/v1/builds/upload",
    headers={
        "X-Api-Key": os.environ["NUNU_API_TOKEN"],
        "Content-Type": "application/json"
    },
    json={
        "project_id": "your-project-id",
        "name": "Production Build v1.2.3",
        "file_name": "app-release.apk",
        "file_size": 52428800,
        "platform": "android",
        "multipart": False
    }
)
data = response.json()
```
</RequestExample>

<ResponseExample>
```json Single-Part
{
  "upload_type": "single-part",
  "build_id": "123e4567-e89b-12d3-a456-426614174000",
  "upload_url": "https://storage.example.com/...",
  "object_key": "abc123-def456/app-release.apk"
}
```

```json Multipart
{
  "upload_type": "multipart",
  "build_id": "123e4567-e89b-12d3-a456-426614174000",
  "upload_id": "ExampleUploadId123",
  "object_key": "abc123-def456/large-app.apk",
  "total_parts": 52,
  "part_size": 104857600
}
```

```json 402 Quota Exceeded
{
  "error": "Storage capacity exceeded",
  "code": "QUOTA_EXCEEDED",
  "details": {
    "used": 10737418240,
    "capacity": 10737418240,
    "needed": 524288000
  }
}
```
</ResponseExample>

---

## Upload Flow

<Tabs>
  <Tab title="Single-Part Upload">
    <Steps>
      <Step title="Initiate">
        POST to `/builds/upload` with `multipart: false`
      </Step>
      <Step title="Upload">
        PUT the file to the returned `upload_url`
      </Step>
      <Step title="Complete">
        POST to `/builds/upload/complete`
      </Step>
    </Steps>
  </Tab>
  <Tab title="Multipart Upload">
    <Steps>
      <Step title="Initiate">
        POST to `/builds/upload` (automatic for files ≥3GB)
      </Step>
      <Step title="Get Part URLs">
        GET `/builds/upload/parts` for presigned URLs
      </Step>
      <Step title="Upload Parts">
        PUT each part to its URL, save ETags
      </Step>
      <Step title="Complete">
        POST to `/builds/upload/complete` with ETags
      </Step>
    </Steps>
  </Tab>
</Tabs>

## Complete Single-Part Example

<CodeGroup>

```bash Shell Script
#!/bin/bash
PROJECT_ID="your-project-id"
API_TOKEN="your-api-token"
FILE_PATH="build/app.apk"

# Step 1: Initiate
RESPONSE=$(curl -s -X POST \
  "https://nunu.ai/api/v1/builds/upload" \
  -H "Content-Type: application/json" \
  -H "X-Api-Key: $API_TOKEN" \
  -d "{
    \"project_id\": \"$PROJECT_ID\",
    \"name\": \"Production Build\",
    \"file_name\": \"$(basename $FILE_PATH)\",
    \"file_size\": $(stat -f%z $FILE_PATH 2>/dev/null || stat -c%s $FILE_PATH),
    \"platform\": \"android\",
    \"multipart\": false
  }")

UPLOAD_URL=$(echo $RESPONSE | jq -r '.upload_url')
BUILD_ID=$(echo $RESPONSE | jq -r '.build_id')

# Step 2: Upload
curl -X PUT "$UPLOAD_URL" \
  -H "Content-Type: application/octet-stream" \
  --data-binary "@$FILE_PATH"

# Step 3: Complete
curl -X POST \
  "https://nunu.ai/api/v1/builds/upload/complete" \
  -H "Content-Type: application/json" \
  -H "X-Api-Key: $API_TOKEN" \
  -d "{\"build_id\": \"$BUILD_ID\"}"

echo "Upload complete! Build ID: $BUILD_ID"
```

```typescript JavaScript
async function uploadBuild(projectId: string, file: File, name: string, platform: string) {
  const token = process.env.NUNU_API_TOKEN;

  // Step 1: Initiate
  const initRes = await fetch("https://nunu.ai/api/v1/builds/upload", {
    method: "POST",
    headers: { "Content-Type": "application/json", "X-Api-Key": token },
    body: JSON.stringify({
      project_id: projectId,
      name,
      file_name: file.name,
      file_size: file.size,
      platform,
      multipart: false,
    }),
  });
  const { upload_url, build_id } = await initRes.json();

  // Step 2: Upload
  await fetch(upload_url, {
    method: "PUT",
    body: file,
    headers: { "Content-Type": "application/octet-stream" },
  });

  // Step 3: Complete
  await fetch("https://nunu.ai/api/v1/builds/upload/complete", {
    method: "POST",
    headers: { "Content-Type": "application/json", "X-Api-Key": token },
    body: JSON.stringify({ build_id }),
  });

  return build_id;
}
```

```python Python
import requests
import os

def upload_build(project_id: str, file_path: str, name: str, platform: str) -> str:
    token = os.environ["NUNU_API_TOKEN"]
    file_size = os.path.getsize(file_path)
    
    # Step 1: Initiate
    init_res = requests.post(
        "https://nunu.ai/api/v1/builds/upload",
        headers={"Content-Type": "application/json", "X-Api-Key": token},
        json={
            "project_id": project_id,
            "name": name,
            "file_name": os.path.basename(file_path),
            "file_size": file_size,
            "platform": platform,
            "multipart": False
        }
    )
    data = init_res.json()
    
    # Step 2: Upload
    with open(file_path, "rb") as f:
        requests.put(data["upload_url"], data=f, 
                     headers={"Content-Type": "application/octet-stream"})
    
    # Step 3: Complete
    requests.post(
        "https://nunu.ai/api/v1/builds/upload/complete",
        headers={"Content-Type": "application/json", "X-Api-Key": token},
        json={"build_id": data["build_id"]}
    )
    
    return data["build_id"]
```

</CodeGroup>
